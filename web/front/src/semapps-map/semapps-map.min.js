Polymer({is:'semapps-map',properties:{route:{type:Object,observer:'_routeChanged'},pins:{type:Array,value:[]}},attached(){this.ready=!1,semapps.map=this,SemAppsCarto.ready(this.start.bind(this))},start(){'use strict';this.globalX=48.862725,this.globalY=2.287592000000018,this.globalZoom=6;let a=semapps.isAnonymous()?12:18;this.OSM=L.map('semapps',{maxZoom:a,minZoom:0}).setView([this.globalX,this.globalY],this.globalZoom),L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this.OSM),this.markers=L.markerClusterGroup(),this.OSM.addLayer(this.markers),this.OSM.scrollWheelZoom.disable(),this.OSM.off('dblclick'),this.OSM.on('dblclick',onMapClick),this.OSM.on('mouseover',mouseOver),this.OSM.on('mouseout',mouseOut),this.pinAvailaible=[],this.awesome={'http://virtual-assembly.org/pair#Person':L.AwesomeMarkers.icon({icon:'user',markerColor:'blue'}),'http://virtual-assembly.org/pair#Organization':L.AwesomeMarkers.icon({icon:'tower',markerColor:'blue'}),'http://virtual-assembly.org/pair#Project':L.AwesomeMarkers.icon({icon:'screenshot',markerColor:'red'}),'http://virtual-assembly.org/pair#Event':L.AwesomeMarkers.icon({icon:'calendar',markerColor:'orange'}),'http://virtual-assembly.org/pair#Proposal':L.AwesomeMarkers.icon({icon:'info-sign',markerColor:'green'}),'http://virtual-assembly.org/pair#Document':L.AwesomeMarkers.icon({icon:'folder-open',markerColor:'black'})},hider()},pinShowAll(){'use strict';for(let a in this.pins)this.pins.hasOwnProperty(a)&&this.pinShow(a)},pinShow(a){'use strict';this.pins.hasOwnProperty(a)&&this.pinAvailaible[a]?(this.markers.addLayer(this.pins[a]),this.pinAvailaible[a]=!1):(log('error: '+a+' is not a marker'),log(this.pins))},addPin(a,b,c,d,f){'use strict';this.pinAvailaible[c]=!0,this.pins[c]=void 0===this.awesome[f]?L.marker([a,b]).bindPopup('<a href="#" onclick="getDetail(this)" rel="'+c+'"><h5>'+d+' </h5></a>'):L.marker([a,b],{icon:this.awesome[f]}).bindPopup('<a href="#" onclick="getDetail(this)" rel="'+c+'"><h5>'+d+'</h5> </a>'),this.pinShow(c)},pinShowOne(a){'use strict';this.pinHideAll(),this.pinShow(a),this.OSM.setView(this.pins[a].getLatLng(),15,{animate:!0})},pinHide(a){'use strict';if(this.pins[a]!==void 0&&!this.pinAvailaible[a]){let b=this.pins[a];this.markers.removeLayer(b),this.pinAvailaible[a]=!0}},pinHideAll(){'use strict';for(let a in log('start pinHideAll'),log(this.pins),this.pins)this.pins.hasOwnProperty(a)&&this.pinHide(a);log('stop pinHideAll')},zoomGlobal(){this.OSM.setView([this.globalX,this.globalY],this.globalZoom)},handleClick(a){a.preventDefault(),semapps.scrollToContent(),semapps.myRoute='detail',semapps.goToPath('detail',{uri:window.encodeURIComponent(this.uri)})}});function onMapClick(){log('onMapClick'),semapps.map.OSM.scrollWheelZoom.enabled()?semapps.map.OSM.scrollWheelZoom.disable():semapps.map.OSM.scrollWheelZoom.enable(),mouseOver()}function mouseOver(){log('mouseOver');let b=document.getElementById('semapps-map-black');semapps.map.OSM.scrollWheelZoom.enabled()?($('#semapps-map-black').animate({height:'0px'},'fast','linear'),$('#semapps-map-message').hide()):($('#semapps-map-black').animate({height:'100%'},'fast','linear'),b.style.display='block',$('#semapps-map-message').show())}function mouseOut(){log('mouseOut'),$('#semapps-map-message').hide(),$('#semapps-map-black').animate({height:'0px'},'fast','linear')}function getDetail(a){semapps.goToPath('detail',{uri:window.encodeURIComponent(a.rel)})}function hider(){var a=document.getElementById('hider_block');a.addEventListener('click',function(){let c=document.querySelector('.mapContent'),d=$(a),f=document.getElementById('hider_text'),g=d.hasClass('shown');g?(d.removeClass('shown'),d.addClass('notshown'),f.innerText='Afficher la carte',$(c).hide()):(d.addClass('shown'),d.removeClass('notshown'),f.innerText='Cacher la carte',$(c).show())})}
//# sourceMappingURL=semapps-map.min.js.map
